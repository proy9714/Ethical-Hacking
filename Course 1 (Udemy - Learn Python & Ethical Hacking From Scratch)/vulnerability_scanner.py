#!/usr/bin/env python

from scanner import scanner

### AGAINST METASPLOITABLE ###
target_url = "http://10.0.2.11/dvwa/"

# These links are to be ignored,
# so that logout links can be avoided and the user remains logged in
links_to_ignore = ["http://10.0.2.11/dvwa/logout.php"]

# The first field is the name of the field in the input tag
data_dict = {"username": "admin", "password": "password", "Login":"submit"}

vuln_scanner = scanner(target_url, links_to_ignore)
# Preserving the session using the session variable in scanner.py
# This is done so that theb user remains logged in
# vuln_scanner.session.post("http://theatreofdreams.000webhostapp.com/", data=data_dict)
vuln_scanner.crawl()
vuln_scanner.run_scanner()

# link = "http://10.0.2.11/dvwa/vulnerabilities/xss_r/"
# forms = vuln_scanner.extract_forms(link)
# print(forms)

# Testing XSS vulnerabilities
# response = vuln_scanner.test_xss_in_form(forms[0], link)
# link = "http://10.0.2.11/dvwa/vulnerabilities/xss_r/?name=testtest#"
# response = vuln_scanner.test_xss_in_link(link)
# print(response)